!function(t){"use strict";function o(){}function r(e){this.animationID=e}o.prototype.get=function(e){if(localStorage){var t=JSON.parse(localStorage.getItem(e));if(null==t)return null;var o=new Date;if("null"==t.expires_at||t.expires_at>=o.getTime())return t.value}return null},o.prototype.set=function(e,t,o){if(o=o||null,localStorage){var r=new Date,i={created_at:r.getTime(),expires_at:o?r.getTime()+1e3*o:"null",value:t};localStorage.setItem(e,JSON.stringify(i))}},o.prototype.clear=function(e){localStorage&&localStorage.removeItem(e)},o.prototype.exists=function(e){if(localStorage){var t=JSON.parse(localStorage.getItem(e));if(null==t)return!1;var o=new Date;return!("null"!=t.expires_at&&t.expires_at<o.getTime())}return!1},t.GeoIPService=function(e){this.countries=e.countries,this.loaderSelectorID=e.loaderSelectorID,this.LS_RESPONSE_KEY="LS_RESPONSE_KEY__v4",this.API_MAX_WAIT_TIME=2e3,this.localStorageCacheService=new o,this.animationService=new r(e.loaderSelectorID)},GeoIPService.prototype.prepareCountries=function(){var t=this,e=[].concat(t.countries);t.countries={},e.forEach(function(e){t.countries[e.toUpperCase()]={NAME:e.toUpperCase(),PATH:"/"+e}})},GeoIPService.prototype.validateOptions=function(){var e=this;if(!e.countries||Array.isArray(e.countries)&&!e.countries.length)throw new Error("==> Required options: [countries] are not provided!");if(!e.loaderSelectorID)throw new Error("==> Required options: [loaderSelectorID] are not provided!")},GeoIPService.prototype.isChecked=function(){return this.localStorageCacheService.exists(this.LS_RESPONSE_KEY)},GeoIPService.prototype.isCurrentCountryEquals=function(e){return t.location.pathname.match(new RegExp(e.toLowerCase(),"g"))},GeoIPService.prototype.redirectTo=function(e){t.location=this.countries[e.toUpperCase()].PATH},GeoIPService.prototype.checkCountryAndTryRedirect=function(t){var o=this;console.log("==> Checking country..."),o.apiRequestedAt=(new Date).getTime(),geoip2.country(function(e){return(new Date).getTime()-o.apiRequestedAt>o.API_MAX_WAIT_TIME?(console.log("==> The wait operation timed out"),o.animationService.hideLoading()):o.isChecked()?(console.log("==> Redirect skipped because country was already checked"),"function"==typeof t&&t(null,e),o.animationService.hideLoading({immediately:!0})):(o.localStorageCacheService.set(o.LS_RESPONSE_KEY,e),console.log("==> GeoIP check successfully saved"),o.countries[e.country.iso_code]&&!o.isCurrentCountryEquals(e.country.iso_code)&&o.redirectTo(e.country.iso_code),o.animationService.hideLoading(),void("function"==typeof t&&t(null,e)))},function(e){throw o.animationService.hideLoading(),"function"==typeof t&&t(e),new Error("==> An error occur:"+JSON.parse(e))},{})},GeoIPService.prototype.start=function(e){this.validateOptions(),this.prepareCountries(),this.checkCountryAndTryRedirect(e)},r.prototype.hideLoading=function(e){var t=this;if(Object.assign({},e).immediately){var o=document.getElementsByTagName("html")[0];o.className=o.className+" hide-loader"}var r=document.getElementById(t.animationID);r?setTimeout(function(){r&&r.classList.remove("show-html")},500):document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById(t.animationID);setTimeout(function(){e&&e.classList.remove("show-html")},500)},!1)}}(window);